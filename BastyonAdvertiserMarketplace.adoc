## Bastyon Decentralized Ad Marketplace

The Bastyon Decentralized Ad Marketplace will enable sponsored content on the Bastyon social media site through a new transaction type called Ad Post.  Both the advertiser and recipient of the advertiser will agree to the transaction.  This model allows advertisers to target specific audiences, and allows content creators 
the power to choose what types of advertisements are allowed on their channel, versus ceding control to a centralized advertisement authority as it the case with mainstream social media platforms.

## Example Usage Model

. Blogger sets price for an ad
 Node: add to user info
 Front End: create transaction Set Price for text/image or video (different prices)

. Advertiser creates a special type of a post – Ad Post. It contains a partially signed Ad transaction with an ad for a given blogger. All that remains is the blogger’s signature. It is attached as text to the Ad Post. Inputs have to be non-wallet inputs and cannot be moved (on the front end) until the time expiration (3 days for the ad). 
PKOIN is added that is equal to the price of the blogger is Set Price (text/image or video different)
..Node: new transaction Ad Post
..Don’t allow to move money from the input that is used in the ad transaction for 3 days [3 days seems short]

. Advertiser can look for bloggers to offer the post to by using search based on :
.. Number of followers: NF
.. Categories/Hashtags used
.. Activity (number of ratings/comments underneath the posts)
.. Video or textual
.. Price for an ad per follower
.. Percentage of ads accepted
.. Similar bloggers based on an initial set of bloggers (Recommended bloggers by bloggers – API call exists)
... Node: API calls to power the search
... Front End: Intuitive search form, as bloggers are added, sum recalculated
. Multi-sig tx is attached to an Ad Post as a post
. Blogger opens an Ad Offers report, reviews the ad and decides to repost or not
... Front End: create a report for a blogger to review all ads, reputation of the advertiser

. When reposting blogger’s front end checks that the PKOIN input is still valid, and then sends the Multisig tx (which is a repost) to the node. *blogger cannot delete an ad*


## Blockchain Implementation Options

Below are various implementation options for Ad Marketplace on the backend node side, with pro's and con's for each.

### BitCoin Multisig Transaction
Bitcoin multisig transactions are intented to enable multi-party authentication of transactions out of a wallet as additional security.  It may be possible to repurpose Multsig transactions for Ad Marketplace.  With this model, if Alice wants to advertise on Bob's feed, she would create a new raw Ad transaction with both Alice and Bob's public keys, the PKOIN amount, and reference to a post ID in the transaction payload containing the advertised content.  Alice would sign the transaction, then the raw transaction needs to be sent to Bob for signing for approval. Bob sends the fully signed transaction to a node via createrawtransaction API which transfers the PKION from Alice to Bob.  When the transaction is accepted by the blockchain the advertised post will show up in Bob's feed.

Pro's: 
 - Uses existing battletested Bitcoin code
 - Multisig compatible with Pocketnet addresses in use on network
Cons:
 - Requires public key of both users, which can theoretically be extracted from Bob's previous transactions on blockchain
 - Raw transaction needs to be sent from Alice to Bob before being submitted as a transaction to a node.  There will need to be a communication method for final signing.
 
### Request + Response Multisig
Ad transaction would be split into a new Ad request transaction submitted by Alice, Bob submits a Ad response transaction to receive the coins and accept the transaction.  Partial transaction could be place on blockchain with only Alice's signature as a advertisement request tx.  Special concensus rules would require Bob to create a second advertiser approval transaction with input from Alice's transaction to accept it before being able to spend the coins.  Alice's initial Ad request transaction should be charged a TX fee to prevent attacks to the block chain, regardless of whether request is accepted.

Pros
 - Additional communication channel is not necessary because the entire transaction occurs on the blockchain

Cons
 - Additional space required on the block chain for both request and response tx
 - New tx consensus rules and script transaction opens potential security and exploit vulnerabilities
 - Since transaction is on block chain, 3 day windows for acceptance becomes more difficult.


### P2SH
Potentially P2SH (Pay 2 Script Hash) transaction could be used to implement advertisement marketplace.  Alice submits a P2SH transaction of type Ad, proposed coin amount, and final script hash expected to be generated by Bob's redemption script.  The Bastyon front end client sets up a redemption script with Bob's public key which Bob runs to either Accept (coins go to bob) or Reject (coins return to Alice). 
Pros
 - Potentially could be done using existing P2SH Bitcoin code
Cons
 - Requires Segwit wallet address, current PKOIN addresses are legacy format.
 - Space required on blockchain, even for rejected requests.
 - Since transaction is on block chain, 3 day windows for acceptance becomes more difficult.


### Off Chain (BIP 70 Payments Protocol, Mempool, other layer2)
Potentially, the Ad request could be sent via an alternate communication channel such as re-enabling the Bitcoin payments protocol, using the node Mempool, or another layer 2 communication method such as the Bastyon app.  The Ad is only added on chain as a new transaction when signed by both parties (similar to Bitcoin Multisig above).

Pros
- Less data on blockchain
- Potentially faster to propagate through network but may also
- Flexible time limits request
- Should work with existing bitcoin script and consensus rules
Cons
- New communication channel needs to be brought online and debugged, may be difficult implementation

##Test Plan
Develop unit test to verify each step in workflow above between to parties.
Unit test to verify advertised content appears as expected in target feed.

